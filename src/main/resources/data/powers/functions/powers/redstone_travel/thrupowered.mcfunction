
# find direction
## get pos's
summon marker ~ ~ ~ {Tags:["pos2"]}
execute store result score nx num run data get entity @e[tag=pos2,limit=1] Pos[0]
execute store result score ny num run data get entity @e[tag=pos2,limit=1] Pos[1]
execute store result score nz num run data get entity @e[tag=pos2,limit=1] Pos[2]

execute store result score x num run data get entity @e[tag=prevpos,limit=1] Pos[0]
execute store result score y num run data get entity @e[tag=prevpos,limit=1] Pos[1]
execute store result score z num run data get entity @e[tag=prevpos,limit=1] Pos[2]
## new - past

scoreboard players operation nx num -= x num
scoreboard players operation ny num -= y num
scoreboard players operation nz num -= z num

# test
## torch -> etc
execute at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_torch at @e[tag=pos2] if score nx num matches 0 if score ny num matches 2 if score nz num matches 0 if block ~ ~ ~ minecraft:redstone_torch run scoreboard players set Safe num 2
execute at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_torch at @e[tag=pos2] if score nx num matches 0 if score ny num matches 2 if score nz num matches 0 if block ~ ~ ~ minecraft:redstone_wire run scoreboard players set Safe num 2

## imput -> etc
execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=south] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ #powers:imputs at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=north] run scoreboard players set Safe num 2

## repeater -> etc
execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=south] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=north] run scoreboard players set Safe num 2

## comparator -> etc
execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=south] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=north] run scoreboard players set Safe num 2

## redstone -> etc
execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[west=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[north=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[east=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[south=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[west=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[north=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[east=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[south=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:comparator if block ~ ~ ~ minecraft:comparator[facing=south] run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[west=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[north=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=south] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[east=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:redstone_wire if block ~ ~ ~ minecraft:redstone_wire[south=side] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:redstone_wall_torch if block ~ ~ ~ minecraft:redstone_wall_torch[facing=north] run scoreboard players set Safe num 2

## observer -> etc
execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 2 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=down] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches -2 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=up] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ redstone_wire run scoreboard players set Safe num 2

execute if score nx num matches 2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=west] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=west] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches 2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=north] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=north] run scoreboard players set Safe num 2
execute if score nx num matches -2 if score ny num matches 0 if score nz num matches 0 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=east] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=east] run scoreboard players set Safe num 2
execute if score nx num matches 0 if score ny num matches 0 if score nz num matches -2 at @e[tag=prevpos,limit=1] if block ~ ~ ~ minecraft:observer if block ~ ~ ~ minecraft:observer[facing=south] at @e[tag=pos,limit=1] unless block ~ ~ ~ #powers:nonsolid unless block ~ ~ ~ #powers:odd_redstone_blocks at @e[tag=pos2,limit=1] if block ~ ~ ~ minecraft:repeater if block ~ ~ ~ minecraft:repeater[locked=false,facing=south] run scoreboard players set Safe num 2

kill @e[tag=pos2]
